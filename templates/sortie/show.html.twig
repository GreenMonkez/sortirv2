{% extends 'base.html.twig' %}

{% block title %}Sortie{% endblock %}

{% block body %}
    <h1>Sortie</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Nom de l'évènement :</th>
                <td>{{ sortie.nom }}</td>
            </tr>
            <tr>
                <th>Organisateur :</th>
                <td>{{ sortie.planner.firstName }} {{ sortie.planner.lastName }}</td>
            </tr>
            <tr>
                <th>Début de l'évènement le :</th>
                <td>{{ sortie.startAt ? sortie.startAt|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>Durée de l'évènement :</th>
                <td>{{ sortie.duration /60}} heures</td>
            </tr>
            <tr>
                <th>Fin des inscriptions le :</th>
                <td>{{ sortie.limitSortieAt ? sortie.limitSortieAt|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>Limite d'inscriptions :</th>
                <td>{{ sortie.limitMembers }}</td>
            </tr>
            <tr>
                <th>Description :</th>
                <td>{{ sortie.description }}</td>
            </tr>
            <tr>
                <th>Adresse :</th>
                <td>{{ sortie.lieu.street }}, {{ sortie.lieu.postaleCode }} {{ sortie.lieu.city }}</td>
            </tr>
            <tr>
                <th>Site :</th>
                <td>{{ sortie.site.name }}</td>
            <tr>
                <th>Etat :</th>
                <td>{{ sortie.status.name }} </td>
            </tr>
            <tr>
                <th>Archive :</th>
                <td>{{ sortie.isArchive ? 'Oui' : 'Non' }}</td>
            </tr>
        </tbody>
    </table>

    <a class="btn btn-primary" href="{{ path('app_sortie_index') }}">back to list</a>
    {% if app.user and sortie.status.name is same as 'Ouverte' and not  sortie.members.contains(app.user) %}
        <form method="post" action="{{ path('app_sortie_sub', {'id': sortie.id}) }}" style="display: inline;">
            <input type="hidden" name="_token" value="{{ csrf_token('inscription' ~ sortie.id) }}">
            <button type="submit" class="btn btn-primary">S'inscrire</button>
        </form>
    {% endif %}
    {% if app.user and  sortie.members.contains(app.user) and (sortie.status.name is same as ('Ouverte') or sortie.status.name is same as ('Cloturée')) %}
        <form method="post" action="{{ path('app_sortie_unSub', {'id': sortie.id}) }}" style="display: inline;">
            <input type="hidden" name="_token" value="{{ csrf_token('desinscription' ~ sortie.id) }}">
            <button type="submit" class="btn btn-primary">Se désister</button>
        </form>
    {% endif %}
{% if is_granted('ROLE_ADMIN') or sortie.planner is same as app.user  %}
    <a class="btn btn-primary" href="{{ path('app_sortie_edit', {'id': sortie.id}) }}">edit</a>

    {{ include('sortie/_delete_form.html.twig') }}
{% endif %}
{% endblock %}
